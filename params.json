{"name":"Exgrip.winrt.logging","tagline":"Simple logging framework for WinRT/Universal apps - can be extended easlily","body":"## ExGrip.WinRT.Logging ##\r\n\r\nYes, another logging framework for WinRT/Universal apps. It works with Windows Phone 8.1 and Windows 8.1 based XAML apps. It is written in C# and inspired by the classes available in the Windows.Foundation.Diagnostics namespace. Because those are not very extensible, I picked up the main concept and created an environment that will allow you to implement your own LoggingChannels or extend existing ones.\r\n\r\n## Prerequisites ##\r\n\r\nSince release 1.1.0 you need to install the SQLite extensions for Windows Phone and Windows Store apps, as well as the SQLite PCL NuGet-Package. The solution will try to restore the NuGet packages automatically, but you need to install the SQLite Visual Studio 2013 extensions for SQLite, you can read how to that here:\r\n\r\n[Portable Class Library for SQLite](https://sqlitepcl.codeplex.com/documentation \"Portable Class Library for SQLite\")\r\n\r\n**NOTE**:\r\nIf you have any problems with the \"Create New NuGet Package From Project After Each Build\"  - just delete that package and compile. A NuGet package will be published soon.\r\n\r\n## How it works ##\r\n\r\nIt's very simple. The whole story is, that there is a class called **LoggingSession**. This class can hold one or more **LoggingChannels** you can send your log-data to. The **LoggingSession** class is a singleton, that will only create one instance of itself at any time. That way it is the centralized point for all of you logging requirements within your app. On Windows Phone or Windows 8.\r\n\r\nEach **LoggingChannel** represents something like the physical storage for your log-data. This can be a file or a database, or for example Windows Azure Storage like table-storage for example.\r\n\r\nA **LoggingChannel** can also be active or inactive. If you add a new **LoggingChannel** to your **LoggingSession** instance and the channel is inactive, the **LoggingSession** will not send you log-messages to that channel. The **LoggingSession** instance can send your log-messages to all registered LogChannels at once or to a specific channel.\r\n\r\nThe solution contains a basic FileLoggingChannel implementation and two sample projects: One for Windows Phone 8.1 and one for Windows 8.1 . \r\n\r\nBoth projects work with the same source on Windows Phone 8.1 and on Windows 8.1. Here is the sample source:\r\n\r\n        using System;\r\n        using System.Collections.Generic;\r\n        using System.IO;\r\n        using System.Linq;\r\n        using System.Runtime.InteropServices.WindowsRuntime;\r\n        using System.Threading.Tasks;\r\n        using ExGrip.WinRT.Logging;\r\n        using ExGrip.WinRT.Logging.Channels;\r\n        using ExGrip.WinRT.Logging.Helpers;\r\n        using ExGrip.WinRT.Logging.LogEntries;\r\n        using ExGrip.WinRT.Logging.Sessions;\r\n        using Windows.Foundation;\r\n        using Windows.Foundation.Collections;\r\n        using Windows.Storage;\r\n        using Windows.UI.Xaml;\r\n        using Windows.UI.Xaml.Controls;\r\n        using Windows.UI.Xaml.Controls.Primitives;\r\n        using Windows.UI.Xaml.Data;\r\n        using Windows.UI.Xaml.Input;\r\n        using Windows.UI.Xaml.Media;\r\n        using Windows.UI.Xaml.Navigation;\r\n\r\n        // The Blank Page item template is documented at http://go.microsoft.com/fwlink/?LinkId=391641\r\n\r\n        namespace LoggerPhone {\r\n            /// <summary>\r\n            /// An empty page that can be used on its own or navigated to within a Frame.\r\n            /// </summary>\r\n            public sealed partial class MainPage : Page {\r\n                public MainPage() {\r\n                    this.InitializeComponent();\r\n\r\n                    this.NavigationCacheMode = NavigationCacheMode.Required;\r\n                }\r\n\r\n                /// <summary>\r\n                /// Invoked when this page is about to be displayed in a Frame.\r\n                /// </summary>\r\n                /// <param name=\"e\">Event data that describes how this page was reached.\r\n                /// This parameter is typically used to configure the page.</param>\r\n                protected override void OnNavigatedTo(NavigationEventArgs e) {\r\n                    // TODO: Prepare page for display here.\r\n\r\n                    // TODO: If your application contains multiple pages, ensure that you are\r\n                    // handling the hardware Back button by registering for the\r\n                    // Windows.Phone.UI.Input.HardwareButtons.BackPressed event.\r\n                    // If you are using the NavigationHelper provided by some templates,\r\n                    // this event is handled for you.\r\n                }\r\n                private async void Button_Click(object sender, RoutedEventArgs e) {\r\n\r\n                    //Get  the LoggingSession instance\r\n                    LoggingSession sess = LoggingSession.Instance;\r\n\r\n                    //Create a new LogChannel\r\n                    MyFileLogChannel lgChannel = new MyFileLogChannel(\"mylog.txt\", Windows.Storage.ApplicationData.Current.LocalFolder);\r\n\r\n                    lgChannel.MaxFileSizeInBytes = 500000;\r\n\r\n                    //Init the channel\r\n                    await lgChannel.Init();\r\n\r\n                    //Activate the channel\r\n                    lgChannel.IsActive = true;\r\n\r\n\r\n                    //Create a new Sqlite log-channel\r\n                    MySqlLiteLogChannel sqlLogChannel = new MySqlLiteLogChannel(\"Log.db\");\r\n                    sqlLogChannel.IsActive = true;\r\n                    sqlLogChannel.MaxFileSizeInBytes = 1048576; //1MB\r\n                    await sqlLogChannel.Init();\r\n\r\n                    //Add the channel to the logging session\r\n                    sess.LoggingChannels.Add(\"filelogger\", lgChannel);\r\n                    sess.LoggingChannels.Add(\"sqlitelogger\", sqlLogChannel);\r\n\r\n                    //Try the concurrent file accesss\r\n                    Parallel.For(0, 10000, async (i) => {\r\n\r\n                        MyFileLogEntry lgEntry = new MyFileLogEntry() {\r\n                            Entry = \"Hello World \" + i,\r\n                            EntrySeverity = LogSeverity.Informational,\r\n                            Time = DateTime.Now\r\n                        };\r\n\r\n                        SqliteLogEntry sqlEntry = new SqliteLogEntry() {\r\n                            Entry = \"Hello World \" + i,\r\n                            EntrySeverity = LogSeverity.Informational\r\n                        };\r\n\r\n                        //Log to a specific channel\r\n                        var entry = await sess.LogToSpecificChannel(\"filelogger\", lgEntry);\r\n\r\n                        var sqLiteEntry = await sess.LogToSpecificChannel(\"sqlitelogger\", sqlEntry);\r\n                    });\r\n\r\n\r\n\r\n                    //How to use the string formatter\r\n                    //Create a format string based on the properties of your object....\r\n                    string format = \"{FirstName}, {LastName} , {Time}\";\r\n\r\n                    //... and of course a object to be parsed ...\r\n                    var testObject = new { FirstName = \"Nikola\", LastName = \"Tesla\", Time = new DateTime(1856, 7, 10) };\r\n\r\n                    //... then call StringFormatter.FormatLogEntry...\r\n                    var formatted = StringFormatter.FormatLogEntry(format, testObject);\r\n\r\n                    //... and enjoy the formatted text :)\r\n                    this.formatTest.Text = formatted;\r\n                }\r\n            }\r\n\r\n            //Sample FileLoggingChannel implementation\r\n            public class MyFileLogChannel : FileLoggingChannel {\r\n                public MyFileLogChannel(string fileName, StorageFolder logFolder) : base(fileName, logFolder) {\r\n                }\r\n            }\r\n\r\n            //Sample SqliteLoggingChannel implementation\r\n            public class MySqlLiteLogChannel : SqliteLoggingChannel {\r\n                public MySqlLiteLogChannel(string databaseFileName) : base(databaseFileName) {\r\n                }\r\n            }\r\n\r\n\r\n            //Sample ILogEntry implementation\r\n            public class MyFileLogEntry : ILogEntry {\r\n                public string Entry {\r\n                    get;\r\n                    set;\r\n                }\r\n\r\n                public LogSeverity EntrySeverity {\r\n                    get;\r\n                    set;\r\n                }\r\n\r\n                public DateTime Time {\r\n                    get;\r\n                    set;\r\n                }\r\n            }\r\n        }\r\n\r\n\r\nFirst implement the abstract class **FileLoggingChannel**  and the interface **ILogEntry**. This will allow you to add your custom file-logging channel to the **LoggingSession** singleton. You instantiate it like this:\r\n\r\n     LoggingSession sess = LoggingSession.Instance;\r\n\r\nThen instantiate your custom file-logging channel and set it active and set the maximum log-file size in bytes. In this sample it is 500KB. If a file grows larger than 500KB it will be archived and zipped. Logging however does/can and will continue. Then call Init() on your file-logging channel. This will create the logfile. Without the call to Init() it will not work. Then add your log-channel to the log-session like this:\r\n\r\n        sess.LoggingChannels.Add(\"filelogger\", lgChannel);\r\n\r\nDo that for any of your custom implemented channels as well. Because the sample is using only one channel, we simply log to a specific channel:\r\n\r\n        //Log to a specific channel\r\n        var entry = await sess.LogToSpecificChannel(\"filelogger\", lgEntry);\r\n\r\nWithin the parallel for-loop you can see how to create a new ILogEntry that can be passed to your channel(s).\r\n\r\n@awsomedevsigner\r\n\r\nThe licensing part:\r\n\r\nThe MIT License (MIT)\r\n\r\nCopyright (c) <year> <copyright holders>\r\n\r\nPermission is hereby granted, free of charge, to any person obtaining a copy\r\n of this software and associated documentation files (the \"Software\"), to deal\r\n in the Software without restriction, including without limitation the rights\r\n to use, copy, modify, merge, publish, distribute, sublicense, and/or sell\r\n copies of the Software, and to permit persons to whom the Software is\r\n furnished to do so, subject to the following conditions:\r\n\r\nThe above copyright notice and this permission notice shall be included in\r\n all copies or substantial portions of the Software.\r\n\r\nTHE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\r\n IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\r\n FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\r\n AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\r\n LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\r\n OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\r\n THE SOFTWARE.\r\n\r\n","google":"","note":"Don't delete this file! It's used internally to help with page regeneration."}